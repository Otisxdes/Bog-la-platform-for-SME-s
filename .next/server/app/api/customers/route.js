"use strict";(()=>{var e={};e.id=636,e.ids=[636],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},4770:e=>{e.exports=require("crypto")},6815:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>g,patchFetch:()=>y,requestAsyncStorage:()=>m,routeModule:()=>p,serverHooks:()=>h,staticGenerationAsyncStorage:()=>f});var s={};t.r(s),t.d(s,{GET:()=>l,dynamic:()=>d});var a=t(9303),n=t(8716),o=t(670),u=t(7070),i=t(3493),c=t(9178);let d="force-dynamic";async function l(e){try{let r=(0,c.Gd)(e);if(!r)return u.NextResponse.json({error:"Unauthorized"},{status:401});let t=(await i._.customer.findMany({where:{sellerId:r},include:{_count:{select:{orders:!0}},orders:{orderBy:{createdAt:"desc"},take:1,select:{createdAt:!0}}},orderBy:{createdAt:"desc"}})).map(e=>({id:e.id,fullName:e.fullName,phone:e.phone,city:e.city,address:e.address,username:e.username,marketingOptIn:e.marketingOptIn,createdAt:e.createdAt,lastUsedAt:e.lastUsedAt,totalOrders:e._count.orders,lastOrderDate:e.orders[0]?.createdAt||null}));return u.NextResponse.json(t)}catch(e){return console.error("Error fetching customers:",e),u.NextResponse.json({error:"Failed to fetch customers"},{status:500})}}let p=new a.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/customers/route",pathname:"/api/customers",filename:"route",bundlePath:"app/api/customers/route"},resolvedPagePath:"/Users/otabek/Downloads/Design/Vibe/Cursor/Bog'la for SME's/app/api/customers/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:m,staticGenerationAsyncStorage:f,serverHooks:h}=p,g="/api/customers/route";function y(){return(0,o.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:f})}},9178:(e,r,t)=>{t.d(r,{Gd:()=>d,Zv:()=>i,ed:()=>c});var s=t(2023),a=t.n(s),n=t(3493);async function o(e,r){return a().compare(e,r)}async function u(e){return n._.seller.findUnique({where:{email:e}})}async function i(e,r){let t=await u(e);if(!t||!await o(r,t.password))return null;let{password:s,...a}=t;return a}function c(e){return Buffer.from(`${e}:${Date.now()}`).toString("base64")}function d(e){let r=e.headers.get("authorization");if(!r||!r.startsWith("Bearer "))return null;try{let e=r.replace("Bearer ",""),[t]=Buffer.from(e,"base64").toString("utf-8").split(":");return t||null}catch{return null}}},3493:(e,r,t)=>{t.d(r,{_:()=>n});let s=require("@prisma/client"),a=globalThis,n=a.prisma??new s.PrismaClient({log:["error"]});a.prisma=n}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[276,972,23],()=>t(6815));module.exports=s})();