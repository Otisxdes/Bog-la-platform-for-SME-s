"use strict";(()=>{var e={};e.id=429,e.ids=[429],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},4770:e=>{e.exports=require("crypto")},1457:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>g,patchFetch:()=>x,requestAsyncStorage:()=>m,routeModule:()=>l,serverHooks:()=>h,staticGenerationAsyncStorage:()=>f});var o={};t.r(o),t.d(o,{GET:()=>p,dynamic:()=>d});var n=t(9303),s=t(8716),a=t(670),i=t(7070),u=t(3493),c=t(9178);let d="force-dynamic";async function p(e,{params:r}){try{let t=(0,c.Gd)(e);if(!t)return i.NextResponse.json({error:"Unauthorized"},{status:401});let o=await u._.customer.findFirst({where:{id:r.id,sellerId:t},include:{orders:{include:{checkoutLink:{select:{id:!0,name:!0}}},orderBy:{createdAt:"desc"}},_count:{select:{orders:!0}}}});if(!o)return i.NextResponse.json({error:"Customer not found"},{status:404});let n=o.orders.map(e=>({...e,contactSnapshot:JSON.parse(e.contactSnapshot)}));return i.NextResponse.json({...o,orders:n})}catch(e){return console.error("Error fetching customer:",e),i.NextResponse.json({error:"Failed to fetch customer"},{status:500})}}let l=new n.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/customers/[id]/route",pathname:"/api/customers/[id]",filename:"route",bundlePath:"app/api/customers/[id]/route"},resolvedPagePath:"/Users/otabek/Downloads/Design/Vibe/Cursor/Bog'la for SME's/app/api/customers/[id]/route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:m,staticGenerationAsyncStorage:f,serverHooks:h}=l,g="/api/customers/[id]/route";function x(){return(0,a.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:f})}},9178:(e,r,t)=>{t.d(r,{Gd:()=>d,Zv:()=>u,ed:()=>c});var o=t(2023),n=t.n(o),s=t(3493);async function a(e,r){return n().compare(e,r)}async function i(e){return s._.seller.findUnique({where:{email:e}})}async function u(e,r){let t=await i(e);if(!t||!await a(r,t.password))return null;let{password:o,...n}=t;return n}function c(e){return Buffer.from(`${e}:${Date.now()}`).toString("base64")}function d(e){let r=e.headers.get("authorization");if(!r||!r.startsWith("Bearer "))return null;try{let e=r.replace("Bearer ",""),[t]=Buffer.from(e,"base64").toString("utf-8").split(":");return t||null}catch{return null}}},3493:(e,r,t)=>{t.d(r,{_:()=>s});let o=require("@prisma/client"),n=globalThis,s=n.prisma??new o.PrismaClient({log:["error"]});n.prisma=s}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),o=r.X(0,[276,972,23],()=>t(1457));module.exports=o})();