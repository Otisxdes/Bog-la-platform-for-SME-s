(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[987],{8954:function(e,t,s){Promise.resolve().then(s.bind(s,4992))},4992:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return i}});var a=s(7437),d=s(2265),r=s(3210),l=s(9116),n=s(2586);function i(e){let{params:t}=e,s=(0,d.use)(t),i=(0,n.useTranslations)("orders.details"),c=(0,n.useTranslations)("common"),o=(0,r.tv)(),[m,x]=(0,d.useState)(null),[u,h]=(0,d.useState)(!0),[g,j]=(0,d.useState)(null),[f,p]=(0,d.useState)(!1),[y,b]=(0,d.useState)(""),[N,v]=(0,d.useState)("");(0,d.useEffect)(()=>{!async function(){try{let e=await (0,l.a)("/api/orders?id=".concat(s.id));if(!e.ok)throw Error("Failed to fetch order");let t=await e.json();if(t.orders&&t.orders.length>0){let e=t.orders[0];x(e),b(e.paymentStatus),v(e.deliveryStatus)}else throw Error("Order not found")}catch(e){j(e.message||"Failed to load order")}finally{h(!1)}}()},[s.id]);let S=async()=>{if(m){p(!0);try{let e=await (0,l.a)("/api/orders",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({orderId:m.id,paymentStatus:y,deliveryStatus:N})});if(!e.ok)throw Error("Failed to update order");let t=await e.json();x(t),alert("Order status updated successfully!")}catch(e){alert(e.message||"Failed to update order")}finally{p(!1)}}};return u?(0,a.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900"})}):g||!m?(0,a.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:[(0,a.jsx)("p",{className:"text-red-800",children:g||"Order not found"}),(0,a.jsx)("button",{onClick:()=>o.back(),className:"mt-4 text-blue-600 hover:underline",children:c("back")})]}):(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center gap-4 mb-6",children:[(0,a.jsxs)("button",{onClick:()=>o.back(),className:"text-gray-600 hover:text-gray-900",children:["â† ",c("back")]}),(0,a.jsx)("h1",{className:"text-2xl font-bold",children:i("title")})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold mb-4",children:i("orderInfo")}),(0,a.jsxs)("dl",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:i("orderNumber")}),(0,a.jsx)("dd",{className:"mt-1 text-sm text-gray-900 font-mono",children:m.id})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:i("createdAt")}),(0,a.jsx)("dd",{className:"mt-1 text-sm text-gray-900",children:new Date(m.createdAt).toLocaleString()})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:i("product")}),(0,a.jsx)("dd",{className:"mt-1 text-sm text-gray-900",children:m.checkoutLink.name})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:"Size"}),(0,a.jsx)("dd",{className:"mt-1",children:(0,a.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800",children:m.selectedSize})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:i("quantity")}),(0,a.jsx)("dd",{className:"mt-1 text-sm text-gray-900",children:m.quantity})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:i("totalPrice")}),(0,a.jsxs)("dd",{className:"mt-1 text-lg font-bold text-gray-900",children:[m.totalPrice.toLocaleString()," ",m.checkoutLink.currency]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:i("deliveryMethod")}),(0,a.jsx)("dd",{className:"mt-1 text-sm text-gray-900 capitalize",children:m.deliveryMethod.replace("_"," ")})]})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold mb-4",children:i("buyerInfo")}),(0,a.jsxs)("dl",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:i("fullName")}),(0,a.jsx)("dd",{className:"mt-1 text-sm text-gray-900",children:m.contactSnapshot.fullName})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:i("phone")}),(0,a.jsx)("dd",{className:"mt-1 text-sm text-gray-900",children:(0,a.jsx)("a",{href:"tel:".concat(m.contactSnapshot.phone),className:"text-blue-600 hover:underline",children:m.contactSnapshot.phone})})]}),m.contactSnapshot.username&&(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:i("telegram")}),(0,a.jsx)("dd",{className:"mt-1 text-sm text-gray-900",children:(0,a.jsx)("a",{href:"https://t.me/".concat(m.contactSnapshot.username.replace("@","")),target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:m.contactSnapshot.username})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:i("city")}),(0,a.jsx)("dd",{className:"mt-1 text-sm text-gray-900",children:m.contactSnapshot.city})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:i("address")}),(0,a.jsx)("dd",{className:"mt-1 text-sm text-gray-900",children:m.contactSnapshot.address})]})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-6 md:col-span-2",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold mb-4",children:i("statuses")}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:i("paymentStatus")}),(0,a.jsxs)("select",{value:y,onChange:e=>b(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,a.jsx)("option",{value:"new",children:i("paymentStatuses.pending")}),(0,a.jsx)("option",{value:"paid",children:i("paymentStatuses.paid")}),(0,a.jsx)("option",{value:"cancelled",children:i("paymentStatuses.cancelled")})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:i("deliveryStatus")}),(0,a.jsxs)("select",{value:N,onChange:e=>v(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,a.jsx)("option",{value:"pending",children:i("deliveryStatuses.pending")}),(0,a.jsx)("option",{value:"sent",children:i("deliveryStatuses.sent")}),(0,a.jsx)("option",{value:"delivered",children:i("deliveryStatuses.delivered")})]})]})]}),(0,a.jsx)("button",{onClick:S,disabled:f||y===m.paymentStatus&&N===m.deliveryStatus,className:"mt-4 bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:f?c("loading"):i("updateStatus")})]})]})]})}},3210:function(e,t,s){"use strict";s.d(t,{rU:function(){return l},jD:function(){return i},tv:function(){return c}});var a=s(7366),d=s(3795);let r=(0,a.R)({locales:["en","uz","ru"],defaultLocale:"en",localePrefix:"as-needed"}),{Link:l,redirect:n,usePathname:i,useRouter:c}=(0,d.os)(r)},9116:function(e,t,s){"use strict";async function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=new Headers(t.headers);{let e=localStorage.getItem("bogla_seller");if(e)try{let t=JSON.parse(e);t.id&&s.set("X-Seller-ID",t.id)}catch(e){console.error("Failed to parse seller data:",e)}}return fetch(e,{...t,headers:s})}s.d(t,{a:function(){return a}})}},function(e){e.O(0,[945,673,971,117,744],function(){return e(e.s=8954)}),_N_E=e.O()}]);