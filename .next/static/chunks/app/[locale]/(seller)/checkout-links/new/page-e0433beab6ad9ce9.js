(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[361],{9680:function(e,t,r){Promise.resolve().then(r.bind(r,588))},588:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return m}});var s=r(7437),a=r(2265),i=r(3687),o=r(9501),l=r(3590),n=r(2586),c=r(7119);let d=c.Ry({name:c.Z_().min(1,"Product name is required"),price:c.Rx().int().positive("Price must be positive"),currency:c.Z_().default("UZS"),defaultQty:c.Rx().int().positive().default(1),maxQty:c.Rx().int().positive().optional().nullable(),imageUrl:c.G0([c.Z_().url("Must be a valid URL"),c.i0("")]).optional(),sizes:c.IX(c.Z_().min(1,"Size cannot be empty")).min(1,"At least one size is required"),deliveryOptions:c.Ry({courierCity:c.O7().optional(),pickup:c.O7().optional(),region:c.O7().optional()}).refine(e=>e.courierCity||e.pickup||e.region,{message:"At least one delivery option must be selected"}),paymentNote:c.Z_().min(1,"Payment instructions are required")});c.Ry({checkoutLinkId:c.Z_().min(1),quantity:c.Rx().int().positive("Quantity must be positive"),selectedSize:c.Z_().min(1,"Size selection is required"),deliveryMethod:c.Z_().min(1,"Delivery method is required"),buyer:c.Ry({fullName:c.Z_().min(1,"Full name is required"),phone:c.Z_().regex(/^\+998\d{9}$/,"Invalid Uzbek phone number format"),city:c.Z_().min(1,"City is required"),address:c.Z_().min(1,"Address is required"),username:c.Z_().optional()}),saveDetails:c.O7().default(!1)}),c.Ry({paymentStatus:c.Km(["new","paid","cancelled"]).optional(),deliveryStatus:c.Km(["pending","sent","delivered"]).optional()}),c.Ry({email:c.Z_().email("Invalid email address"),password:c.Z_().min(1,"Password is required")});var u=r(9116);function m(){var e;let t=(0,i.tv)();(0,n.useLocale)();let r=(0,n.useTranslations)(),[c,m]=(0,a.useState)(null),[x,p]=(0,a.useState)(!1),{register:y,handleSubmit:g,formState:{errors:b},watch:h,control:f}=(0,o.cI)({resolver:(0,l.F)(d),defaultValues:{currency:"UZS",defaultQty:1,sizes:[""],deliveryOptions:{courierCity:!1,pickup:!1,region:!1}}}),{fields:k,append:v,remove:N}=(0,o.Dq)({control:f,name:"sizes"}),j=h("deliveryOptions"),w=async e=>{p(!0),m(null);try{var r;let s={...e,sizes:e.sizes.filter(e=>""!==e.trim()),maxQty:isNaN(e.maxQty)?void 0:e.maxQty,imageUrl:(null===(r=e.imageUrl)||void 0===r?void 0:r.trim())||""};console.log("Submitting checkout link data:",s);let a=await (0,u.a)("/api/checkout-links",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!a.ok){let e=await a.json();console.error("API Error:",e);let t=e.details?"".concat(e.error,": ").concat(JSON.stringify(e.details)):e.error||"Failed to create checkout link";throw Error(t)}t.push("/checkout-links")}catch(e){console.error("Form submission error:",e),m(e.message||"Failed to create checkout link. Please try again."),p(!1)}};return(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold mb-6",children:r("checkoutLinks.create.title")}),c&&(0,s.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-md p-4 mb-6",children:(0,s.jsx)("p",{className:"text-sm text-red-800",children:c})}),(0,s.jsxs)("form",{onSubmit:g(w),className:"bg-white rounded-lg shadow p-6 space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r("checkoutLinks.create.productName")," *"]}),(0,s.jsx)("input",{type:"text",...y("name"),placeholder:r("checkoutLinks.create.productNamePlaceholder"),className:"w-full px-3 py-2.5 bg-gray-50 border border-gray-200 rounded-lg text-gray-900 placeholder:text-gray-400 focus:outline-none focus:bg-white focus:border-gray-300 transition-colors"}),b.name&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:b.name.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r("checkoutLinks.create.size")," *"]}),(0,s.jsxs)("div",{className:"space-y-2",children:[k.map((e,t)=>(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("input",{type:"text",...y("sizes.".concat(t)),placeholder:r("checkoutLinks.create.sizePlaceholder"),className:"flex-1 px-3 py-2.5 bg-gray-50 border border-gray-200 rounded-lg text-gray-900 placeholder:text-gray-400 focus:outline-none focus:bg-white focus:border-gray-300 transition-colors"}),k.length>1&&(0,s.jsx)("button",{type:"button",onClick:()=>N(t),className:"px-3 py-2 bg-red-50 text-red-600 rounded-lg hover:bg-red-100 transition-colors",children:"Remove"})]},e.id)),(0,s.jsx)("button",{type:"button",onClick:()=>v(""),className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:"+ Add another size"})]}),b.sizes&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:Array.isArray(b.sizes)?null===(e=b.sizes.find(e=>null==e?void 0:e.message))||void 0===e?void 0:e.message:b.sizes.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:r("checkoutLinks.create.productImage")}),(0,s.jsx)("input",{type:"url",...y("imageUrl"),placeholder:r("checkoutLinks.create.productImagePlaceholder"),className:"w-full px-3 py-2.5 bg-gray-50 border border-gray-200 rounded-lg text-gray-900 placeholder:text-gray-400 focus:outline-none focus:bg-white focus:border-gray-300 transition-colors"}),b.imageUrl&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:b.imageUrl.message}),(0,s.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:r("checkoutLinks.create.productImageHelp")})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r("checkoutLinks.create.price")," *"]}),(0,s.jsx)("input",{type:"number",step:"1",...y("price",{valueAsNumber:!0}),className:"w-full px-3 py-2.5 bg-gray-50 border border-gray-200 rounded-lg text-gray-900 placeholder:text-gray-400 focus:outline-none focus:bg-white focus:border-gray-300 transition-colors"}),b.price&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:b.price.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:r("checkoutLinks.create.currency")}),(0,s.jsx)("input",{type:"text",...y("currency"),className:"w-full px-3 py-2.5 bg-gray-50 border border-gray-200 rounded-lg text-gray-900 placeholder:text-gray-400 focus:outline-none focus:bg-white focus:border-gray-300 transition-colors"})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:r("checkoutLinks.create.defaultQty")}),(0,s.jsx)("input",{type:"number",step:"1",...y("defaultQty",{valueAsNumber:!0}),className:"w-full px-3 py-2.5 bg-gray-50 border border-gray-200 rounded-lg text-gray-900 placeholder:text-gray-400 focus:outline-none focus:bg-white focus:border-gray-300 transition-colors"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:r("checkoutLinks.create.maxQty")}),(0,s.jsx)("input",{type:"number",step:"1",...y("maxQty",{valueAsNumber:!0}),className:"w-full px-3 py-2.5 bg-gray-50 border border-gray-200 rounded-lg text-gray-900 placeholder:text-gray-400 focus:outline-none focus:bg-white focus:border-gray-300 transition-colors"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[r("checkoutLinks.create.deliveryOptions")," *"]}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("label",{className:"flex items-center cursor-pointer",children:[(0,s.jsx)("input",{type:"checkbox",...y("deliveryOptions.courierCity"),className:"w-4 h-4 text-blue-400 bg-transparent border-gray-100 rounded focus:ring-0 focus:border-gray-200 transition-colors cursor-pointer hover:border-gray-200"}),(0,s.jsx)("span",{className:"ml-3 text-sm text-gray-700",children:r("checkoutLinks.create.courierCity")})]}),(0,s.jsxs)("label",{className:"flex items-center cursor-pointer",children:[(0,s.jsx)("input",{type:"checkbox",...y("deliveryOptions.pickup"),className:"w-4 h-4 text-blue-400 bg-transparent border-gray-100 rounded focus:ring-0 focus:border-gray-200 transition-colors cursor-pointer hover:border-gray-200"}),(0,s.jsx)("span",{className:"ml-3 text-sm text-gray-700",children:r("checkoutLinks.create.pickup")})]}),(0,s.jsxs)("label",{className:"flex items-center cursor-pointer",children:[(0,s.jsx)("input",{type:"checkbox",...y("deliveryOptions.region"),className:"w-4 h-4 text-blue-400 bg-transparent border-gray-100 rounded focus:ring-0 focus:border-gray-200 transition-colors cursor-pointer hover:border-gray-200"}),(0,s.jsx)("span",{className:"ml-3 text-sm text-gray-700",children:r("checkoutLinks.create.regionDelivery")})]})]}),!(null==j?void 0:j.courierCity)&&!(null==j?void 0:j.pickup)&&!(null==j?void 0:j.region)&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:r("checkoutLinks.create.deliveryError")})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r("checkoutLinks.create.paymentNote")," *"]}),(0,s.jsx)("textarea",{...y("paymentNote"),rows:4,placeholder:r("checkoutLinks.create.paymentNotePlaceholder"),className:"w-full px-3 py-2.5 bg-gray-50 border border-gray-200 rounded-lg text-gray-900 placeholder:text-gray-400 focus:outline-none focus:bg-white focus:border-gray-300 transition-colors"}),b.paymentNote&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:b.paymentNote.message})]}),(0,s.jsxs)("div",{className:"flex gap-4",children:[(0,s.jsx)("button",{type:"submit",disabled:x,className:"bg-blue-600 text-white px-6 py-2 rounded-md font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:x?r("checkoutLinks.create.submitting"):r("checkoutLinks.create.submit")}),(0,s.jsx)("button",{type:"button",onClick:()=>t.back(),className:"bg-gray-200 text-gray-800 px-6 py-2 rounded-md font-medium hover:bg-gray-300",children:r("common.cancel")})]})]})]})}},3687:function(e,t,r){"use strict";r.d(t,{jD:function(){return n},rU:function(){return o},tv:function(){return c}});var s=r(7366),a=r(3795);let i=(0,s.R)({locales:["ru","uz"],defaultLocale:"ru",localePrefix:"as-needed"}),{Link:o,redirect:l,usePathname:n,useRouter:c}=(0,a.os)(i)},9116:function(e,t,r){"use strict";async function s(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=new Headers(t.headers);{let e=localStorage.getItem("bogla_seller");if(e)try{let t=JSON.parse(e);t.id&&r.set("X-Seller-ID",t.id)}catch(e){console.error("Failed to parse seller data:",e)}}return fetch(e,{...t,headers:r})}r.d(t,{a:function(){return s}})}},function(e){e.O(0,[171,673,626,971,117,744],function(){return e(e.s=9680)}),_N_E=e.O()}]);